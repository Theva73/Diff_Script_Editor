<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mobile Code Editor - No Overlap</title>
  <!-- CodeMirror CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css">

  <style>
    /* Basic Reset */
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background-color: #121212;
      color: #f5f5f5;
      overflow: hidden; /* Avoid extra scroll in iOS Safari */
    }

    /* File input container (top) */
    #fileContainer {
      padding: 5px;
      background: #2a2a2a;
      border-bottom: 1px solid #333;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      z-index: 10;
    }
    #fileContainer label {
      margin-bottom: 4px;
      color: #f5f5f5;
      font-size: 14px;
    }
    #fileContainer input {
      padding: 6px;
      font-size: 12px;
      width: 80%;
      max-width: 300px;
      border-radius: 16px;
      border: 1px solid #555;
      background: #3a3a3a;
      color: #f5f5f5;
    }
    .clear-button {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 8px 10px;
      border-radius: 16px;
      border: 1px solid #c0392b;
      background: #e74c3c;
      color: white;
      cursor: pointer;
      font-size: 12px;
      white-space: nowrap;
      transition: all 0.2s ease;
      min-width: 60px;
      width: 90%;
      max-width: 300px;
      text-align: center;
      margin: 10px auto;
    }

    /* Main container uses the rest of screen height */
    .main-container {
      display: flex;
      flex-direction: column;
      height: calc(100vh - 50px); /* 50px approx top bar height */
      overflow: hidden;
      position: relative;
    }

    /* Tab bar */
    .tab-bar {
      display: flex;
      padding: 4px 5px;
      gap: 4px;
      background: #2a2a2a;
      border-bottom: 1px solid #333;
      z-index: 10;
      /* Force horizontal scroll, no wrap */
      flex-wrap: nowrap;
      white-space: nowrap;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      font-size: 12px;
    }
    .tab-button {
      flex: 0 0 auto; /* Donâ€™t let buttons grow/wrap */
      padding: 6px 10px;
      min-width: 60px;
      font-size: 12px;
      border: 1px solid #555;
      background: #3a3a3a;
      color: #f5f5f5;
      border-radius: 20px;
      cursor: pointer;
      text-align: center;
    }
    .tab-button.active {
      background: #0095ff;
      color: #fff;
      border-color: #0077cc;
    }

    /* Toolbar with buttons, same approach */
    .toolbar {
      display: flex;
      padding: 4px 5px;
      gap: 4px;
      background: #2a2a2a;
      border-bottom: 1px solid #333;
      z-index: 10;
      flex-wrap: nowrap; /* no wrapping */
      white-space: nowrap;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      font-size: 12px;
    }
    .tool-button {
      flex: 0 0 auto; /* no wrap */
      padding: 6px 10px;
      min-width: 60px;
      font-size: 12px;
      border: 1px solid #555;
      background: #3a3a3a;
      color: #f5f5f5;
      border-radius: 20px;
      cursor: pointer;
      text-align: center;
    }
    .tool-button.primary {
      background: #0095ff;
      color: #fff;
      border-color: #0077cc;
    }

    /* Editor container */
    .editor-container {
      flex: 1;
      background: #1a1a1a;
      overflow: auto;
      position: relative;
      min-height: 0;
    }
    /* CodeMirror theme */
    .cm-s-darkmode.CodeMirror {
      background: #1a1a1a !important;
      color: #f5f5f5 !important;
    }
    .cm-s-darkmode .CodeMirror-gutters {
      background: #2a2a2a !important;
      border-right: 1px solid #333 !important;
    }
    .cm-s-darkmode .CodeMirror-linenumber {
      color: #aaa !important;
      font-weight: bold;
    }
    .CodeMirror {
      height: 100% !important;
      font-size: 14px;
      line-height: 1.6;
    }

    /* Bottom toolbar also no-wrap */
    .bottom-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 10px;
      background: #2a2a2a;
      border-top: 1px solid #333;
      z-index: 10;
      font-size: 12px;
      flex-wrap: nowrap;
      overflow-x: auto;
      white-space: nowrap;
    }
    .nav-buttons {
      display: flex;
      gap: 10px;
      flex: 0 0 auto;
    }
    .nav-button, .action-button {
      background: transparent;
      border: none;
      color: #4a90e2;
      font-size: 20px;
      cursor: pointer;
      padding: 4px;
      flex: 0 0 auto;
    }
    .done-button {
      color: #4a90e2;
      font-size: 16px;
      font-weight: bold;
      background: transparent;
      border: none;
      padding: 4px 8px;
      cursor: pointer;
      flex: 0 0 auto;
    }

    /* Additional panels like Search Panel, Issues Panel, etc. */
    .search-panel {
      display: none;
      flex-direction: column;
      gap: 8px;
      padding: 8px;
      background: #2a2a2a;
      border-bottom: 1px solid #333;
      z-index: 10;
      font-size: 12px;
    }
    .search-panel.show {
      display: flex;
    }
    .search-panel input {
      padding: 6px 8px;
      border-radius: 12px;
      border: 1px solid #444;
      background: #3a3a3a;
      color: #f5f5f5;
      font-size: 12px;
    }
    .search-buttons {
      display: flex;
      gap: 4px;
      flex-wrap: wrap;
    }
    #searchResults {
      text-align: center;
      color: #ccc;
      font-size: 12px;
      padding: 3px;
      display: none;
    }

    /* Other optional panels, e.g. #issuesPanel, #blockReplacer, etc. omitted for brevity... */
  </style>
</head>
<body>
  <!-- Top bar for file input -->
  <div id="fileContainer">
    <label for="scriptFile">Load Script:</label>
    <input type="file" id="scriptFile" accept=".js,.txt,.html">
    <button class="clear-button" id="clearBtn">ðŸ§¹ Clear Editor</button>
  </div>

  <!-- Main container (tabs, toolbar, editor, bottom toolbar) -->
  <div class="main-container">
    <!-- Tab bar with horizontal scrolling, no wrap -->
    <div class="tab-bar">
      <button class="tab-button active" id="codeTab">Code</button>
      <button class="tab-button" id="previewTab">Preview</button>
      <button class="tab-button" id="consoleTab">Console</button>
      <button class="tab-button" id="diffTab">Diff</button>
    </div>

    <!-- Toolbar with horizontal scrolling, no wrap -->
    <div class="toolbar">
      <button class="tool-button primary" id="runBtn">Run</button>
      <button class="tool-button" id="analyzeBtn">Analyze</button>
      <button class="tool-button" id="findBtn">Find</button>
      <button class="tool-button" id="pasteBtn">Paste</button>
      <button class="tool-button" id="copyBtn">Copy</button>
      <button class="tool-button" id="formatBtn">Format</button>
      <button class="tool-button" id="preFixBtn">Fix</button>
      <button class="tool-button" id="saveBtn">Save</button>
      <button class="tool-button" id="lintBtn">Lint</button>
      <button class="tool-button primary" id="autoFixBtn">Auto Fix</button>
    </div>

    <!-- Optional search panel (hidden by default) -->
    <div class="search-panel" id="searchPanel">
      <!-- ... Find/Replace UI goes here ... -->
    </div>

    <!-- Editor area -->
    <div id="editor" class="editor-container">
      <textarea id="code"></textarea>
      <!-- line-scroll-overlay if needed -->
    </div>

    <!-- Additional views (previewView, consoleView, diffView) go here if needed -->

    <!-- Bottom toolbar with no wrap -->
    <div class="bottom-toolbar">
      <div class="nav-buttons">
        <button class="nav-button">&#8592;</button>
        <button class="nav-button">&#8594;</button>
      </div>
      <button class="action-button" id="blockReplacerBtn">ðŸ“‹</button>
      <button class="action-button">&#128172;</button>
      <button class="done-button">Done</button>
    </div>
  </div>

  <!-- CodeMirror scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/javascript/javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/htmlmixed/htmlmixed.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/css/css.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/xml/xml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/addon/search/searchcursor.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/addon/search/search.min.js"></script>
  <!-- ESLint/Prettier if needed -->
  <script>
    // Initialize CodeMirror
    const editor = CodeMirror.fromTextArea(document.getElementById("code"), {
      mode: "javascript",
      lineNumbers: true,
      lineWrapping: true,
      indentUnit: 2,
      tabSize: 2,
      autofocus: true,
      theme: "darkmode",
      styleActiveLine: true,
      matchBrackets: true,
      scrollbarStyle: "native"
    });

    // Minimal logic to ensure it loads & no overlap
    // Add your existing event listeners (Run, Analyze, Paste, etc.) here
  </script>
</body>
</html>